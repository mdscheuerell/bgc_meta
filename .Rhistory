# I swtiched back to positive. Min here is 0.028, but our SLP DL is 0.004
# this has now been changed to 0.028, following conversations with data providers
ggplot() +
geom_point(data = sol1 %>%
filter(SiteWs == "SLP_W9"), aes(y = NH4_mgL, x = Date)) +
geom_hline(data = sol1, aes(yintercept = DL_NH4_N_mgL), color = "red")
ggplot() +
geom_point(data = sol1, aes(y = NH4_mgL.u, x = Date)) +
geom_hline(data = sol1, aes(yintercept = DL_NH4_N_mgL), color = "red") +
scale_y_log10()+
facet_wrap(vars(SiteWs), scales = "free_y")
### NO3 ----
# - also matters a lot
summary(sol1$DL_NO3_N_mgL)
ggplot() +
geom_point(data = sol1, aes(y = NO3_mgL, x = Date)) +
geom_hline(data = sol1, aes(yintercept = DL_NO3_N_mgL), color = "red") +
facet_wrap(vars(SiteWs), scales = "free_y")
ggplot() +
geom_point(data = sol1, aes(y = NO3_mgL.u, x = Date)) +
geom_hline(data = sol1, aes(yintercept = DL_NO3_N_mgL), color = "red") +
scale_y_log10()+
facet_wrap(vars(SiteWs), scales = "free_y")
### TDP ----
# also matters a lot for HBEF and TLW
summary(sol1$DL_TP_TDP_PO4_P_mgL)
ggplot() +
geom_point(data = sol1, aes(y = TDP_mgL, x = Date)) +
geom_hline(data = sol1, aes(yintercept = DL_TP_TDP_PO4_P_mgL), color = "red") +
facet_wrap(vars(SiteWs), scales = "free_y")
### SO4 ----
# also matters a lot
summary(sol1$DL_SO4_S_mgL)
ggplot() +
geom_point(data = sol1, aes(y = SO4_mgL.u, x = Date)) +
geom_hline(data = sol1, aes(yintercept = DL_SO4_S_mgL), color = "red") +
facet_wrap(vars(SiteWs), scales = "free_y")
## still duplicates? ----
dim(sol1[duplicated(sol1[,c("SiteWs", "Date")]) == TRUE,])
# Drop data we can't use ----
# also remove any datasets where > 50% of samples are > DL
# NH4 =
WStoDropNH4 <-  c("BBWM_EB", "HBEF_WS6", "HJA_GSWS08", "HJA_GSWS09", "SLP_W9", "TLW_C32", "TLW_C35")
# NO3 =
WStoDropNO3 <- "HBEF_WS6"
# TDP =
WStoDropTDP <- c("HBEF_WS6", "HBEF_WS7", "HBEF_WS8", "HBEF_WS9", "SLP_W9")
sol <-  sol1 %>%
select(SiteWs:Q_Ls, Ca_mgL.u:SO4_mgL.u) %>%
# remove u - values now adjusted for the site-specific DL
rename(Ca_mgL = Ca_mgL.u, DOC_mgL = DOC_mgL.u, NH4_mgL = NH4_mgL.u, NO3_mgL = NO3_mgL.u,
TDP_mgL = TDP_mgL.u, SO4_mgL = SO4_mgL.u) %>%
mutate(NH4_mgL = ifelse(SiteWs %in% WStoDropNH4, as.numeric("NA"), NH4_mgL),
NO3_mgL = ifelse(SiteWs == WStoDropNO3, as.numeric("NA"), NO3_mgL),
TDP_mgL = ifelse(SiteWs %in% WStoDropTDP, as.numeric("NA"), TDP_mgL)) %>%
# remove some super high outliers
mutate(TDP_mgL = ifelse(Site == "HJA" & TDP_mgL > 0.1, as.numeric("NA"), TDP_mgL)) %>% # removes 2 points
mutate(NH4_mgL = ifelse(Site == "TLW" & NH4_mgL > 0.2, as.numeric("NA"), NH4_mgL)) # removes 1 point
# export processed df ----
write.csv(sol, file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"))
save.image(file.path(here::here("analysis"), "01cc_data_munging_bringing2gether_Rdat"))
# Libraries ----
library(tidyverse)
solM <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"))
# Conc plots ----
## all sites ----
# NOTE: NOT ALL TDP VALUES ARE TDP SEE WATERSHED DATA NOTES SPREADSHEET
pdf(file.path(here::here("plots"),
"RawConcPlotAllSites20220323.pdf"), width = 25, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
# data
sol <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"))
dev.off()
# Conc plots ----
## all sites ----
# NOTE: NOT ALL TDP VALUES ARE TDP SEE WATERSHED DATA NOTES SPREADSHEET
pdf(file.path(here::here("plots"),
"RawConcPlotAllSites20220323.pdf"), width = 25, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## TLW ----
pdf(file.path(here::here("plots"),
"RawConcPlotTLW_20220323.pdf"), width = 15, height = 10)
ggplot(sol %>%
# rename(TDP_mgL = "SRP_mgL") %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "TLW"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## MEF ----
pdf(file.path(here::here("plots"),
"RawConcPlotMEF_20220323.pdf"), width = 10, height = 10)
ggplot(sol %>%
# rename(TDP_mgL = "SRP_mgL") %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "MEF"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## HJA ----
pdf(file.path(here::here("plots"),
"RawConcPlotHJA_20220323.pdf"), width = 10, height = 10)
ggplot(sol %>%
# rename(TDP_mgL = "SRP_mgL") %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "HJA"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## HBEF ----
pdf(file.path(here::here("plots"),
"RawConcPlotHBEF_20220323.pdf"), width = 20, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "HBEF"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## ELA ----
pdf(file.path(here::here("plots"),
"RawConcPlotELA_20220323.pdf"), width = 12, height = 10)
ggplot(sol %>%
# rename(TDP_mgL = "SRP_mgL") %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "ELA"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## DOR ----
pdf(file.path(here::here("plots"),
"RawConcPlotDOR_20220323.pdf"), width = 25, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "DOR"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## BBWM ----
pdf(file.path(here::here("plots"),
"RawConcPlotBBWM_20220323.pdf"), width = 5, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "BBWM"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
sol <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"))
head(sol)
# data
sol <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"), row.names = 1) %>%
mutate(Date = as.POSIXct(Date, format = "%Y-%m-%d"))
# libraries
library(tidyverse)
# data
sol <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"), row.names = 1) %>%
mutate(Date = as.POSIXct(Date, format = "%Y-%m-%d"))
## Prepare data ----
# using eq here: https://ncwqr.files.wordpress.com/2017/06/d-time-weighted-and-flow-weighted-mean-concentrations.pdf
# Campbell w/ hubbard brook infilled the conc values with means
# going to have to get sol in the right form
# HJA IS FWMC ALREADY
solFW <- sol %>%
ungroup() %>%
# add Interval col
mutate(Interval = as.numeric("NA")) %>%
# wide to long
pivot_longer(cols = c(Ca_mgL:SO4_mgL), names_to = "solute", values_to = "mgL") %>%
mutate(SiteWsSol = paste0(SiteWs, "_", solute)) %>%
select(SiteWsSol, Date, Q_Ls, mgL, Interval) %>%
# need to remove NA's
filter(!is.na(Q_Ls)) %>%
filter(!is.na(mgL)) %>%
# need to arrange
arrange(SiteWsSol, Date)
## Calc interval b/w solute smp ----
# This calculates the interval between samples
SiteWsSolnames <-  unique(solFW$SiteWsSol)
# duplicate for loop
solFW2 <- solFW
# loop to calc interval
for(w in 1:length(SiteWsSolnames)){
# w <- 1
SiteWsSolnames_w <- SiteWsSolnames[w]
sol2_w <- solFW[solFW$SiteWsSol == SiteWsSolnames_w,]
sol2_wDates <- sol2_w$Date
for(t in 2:length(sol2_wDates)){
# t=2
t_i <- sol2_wDates[t]
t_im1 <- sol2_wDates[t-1]
Interval_ti <- as.numeric(t_i - t_im1)
sol2_w[t,]$Interval <- Interval_ti # this will be in days
}
# put back in new df
solFW2[solFW2$SiteWsSol == SiteWsSolnames_w,]$Interval <-  sol2_w$Interval
}
## calc components of FWMC ----
solFW3 <- solFW2 %>%
mutate(Interval = as.numeric(Interval)) %>%
separate(SiteWsSol, sep = "_", into = c("Site", "WS", "Solute", "conc")) %>%
# don't really need conc indicator since always mgL
select(-conc) %>%
# make cols a factor
mutate(across(c(Site, WS, Solute), factor)) %>%
mutate(SiteWs = as.factor(paste0(Site,"_", WS))) %>%
# calculate FWMC
# There's a wide range in this interval 1-5649 days
# <60 = 117653; <30 = 116448; <14 = 101975 <- numbers from the last round of this, but general point stands
# dim(sol3[sol3$Interval <14,])
# If Interval <= 30 then calc FWMC otherwise its an NA
# I'd rather do < 10
mutate(FWMCtop = ifelse(Interval <= 30,
mgL * Interval * (Q_Ls*60*60*24),
as.numeric("NA")), # convert Ls to L/d, as interval is in day
FWMCbottom = ifelse(Interval <= 30,
Interval * (Q_Ls*60*60*24),
as.numeric("NA")),
# this is only for daily stuff - summing for monthly
FWMC = FWMCtop/FWMCbottom) %>%
# HJA is already FWMC - this also circumvents that calculation
mutate(FWMC = ifelse(Site == "HJA", mgL, FWMC))
## Plot intervals ----
pdf(file.path(here::here("plots"),
"IntervalsBWconcSmp_20220324.pdf"), width = 10, height = 25)
ggplot(solFW3, aes(y = log10(Interval), x = Date)) +
geom_point()+
facet_grid(SiteWs ~ Solute, scales = "free_y") +
geom_hline(yintercept = log10(14), color = "red") +
geom_hline(yintercept = log10(30), color = "green")
dev.off()
## Plot intervals ----
pdf(file.path(here::here("plots"),
"IntervalsBWconcSmp_20220324.pdf"), width = 10, height = 25)
ggplot(solFW3, aes(y = log10(Interval), x = Date)) +
geom_point()+
facet_grid(SiteWs ~ Solute, scales = "free_y") +
geom_hline(yintercept = log10(14), color = "green") +
geom_hline(yintercept = log10(30), color = "red")
dev.off()
ggplot(solFW3, aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y")
hist(log10(solFW3$Interval))
# summarize 2 monthly ----
## Conc & Q ----
solM_Qconc <- solFW3 %>%
# make Y and Month cols
mutate(Y = strftime(Date, format = "%Y"),
M = strftime(Date, format = "%m")) %>%
# average to month
group_by(SiteWs, Y, M, Solute) %>%
summarise(across(c(Q_Ls, mgL), ~mean(.x, na.rm = TRUE)))
## FWMC ----
solM_FWMC <- solFW3 %>%
# make Y and Month cols
mutate(Y = strftime(Date, format = "%Y"),
M = strftime(Date, format = "%m")) %>%
# sum to month
group_by(SiteWs, Y, M, Solute) %>%
summarise(across(c(FWMCtop, FWMCbottom), ~sum(.x, na.rm = TRUE))) %>%
mutate(FWMC = FWMCtop/FWMCbottom)
## combine conc, Q, and FWMC ----
solM <- solM_Qconc %>%
full_join(solM_FWMC, by = c("SiteWs", "Y", "M", "Solute")) %>%
mutate(Date = as.Date(paste0(Y,"-",M, "-01"), format = "%Y-%m-%d")) %>%
separate(SiteWs, sep = "_", into = c("Site", "WS"), remove = FALSE) %>%
# HJA conc = FWMC, so we have to do this again
mutate(FWMC = ifelse(Site == "HJA", mgL, FWMC)) %>%
ungroup() %>%
select(-FWMCtop, -FWMCbottom,-Y,-M) %>%
mutate(Site = as.factor(Site),
WS = as.factor(WS)) %>%
# remove SEF
filter(Site != "SEF") %>%
# removing site/solute that are all (or close to all) NAs
# very limited SRP data in SLP - remove
filter(!(Site == "SLP" & Solute == "SRP")) %>%
# MEF NO3 and NH4 data unreliable
filter(!(Site == "MEF" & Solute == "NO3")) %>%
filter(!(Site == "MEF" & Solute == "NH4")) %>%
#no SRP data
filter(!(Site == "BBWM" & Solute == "SRP")) %>%
# too many NA's
filter(!(Site == "SLP" & Solute == "NH4"))
write.csv(solM, file.path(here::here("data/JMHnewMungedDat"),
"01e_ProcessedConcQFwmc_AllSites.csv"))
save.image(file.path(here::here("analysis"), "01e_FWMCcalcs_Rdat"))
save.image(file.path(here::here("analysis"), "01ee_FWMCcalcs_Rdat"))
solM <- read.csv(solM, file.path(here::here("data/JMHnewMungedDat"),
"01e_ProcessedConcQFwmc_AllSites.csv"))
# libraries ----
library(tidyverse)
# data ----
solM <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01e_ProcessedConcQFwmc_AllSites.csv"))
head(solM)
# data ----
solM <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01e_ProcessedConcQFwmc_AllSites.csv"), row.names = 1) %>%
mutate(Date = as.POSIXct(Date, format = "%Y-%m-%d"))
# FWMC plots ----
## all site ----
pdf(file.path(here::here("plots"),
"FWMCPlotAllSites_20220324.pdf"), width = 25, height = 10)
ggplot(solM, aes(y = FWMC, x = Date, color = Site)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## BBWM ----
pdf(file.path(here::here("plots"),
"FWMCPlotBBWM_20220324.pdf"), width = 5, height = 10)
ggplot(solM %>%
filter(Site == "BBWM"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## DOR ----
pdf(file.path(here::here("plots"),
"FWMCPlotDOR_20220324.pdf"), width = 25, height = 10)
ggplot(solM %>%
filter(Site == "DOR"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## ELA ----
pdf(file.path(here::here("plots"),
"FWMCPlotELA_20220324.pdf"), width = 15, height = 10)
ggplot(solM %>%
filter(Site == "ELA"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## HBEF ----
pdf(file.path(here::here("plots"),
"FWMCPlotHBEF_20220324.pdf"), width = 25, height = 10)
ggplot(solM %>%
filter(Site == "HBEF"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## HJA ----
pdf(file.path(here::here("plots"),
"FWMCPlotHJA_20220324.pdf"), width = 10, height = 10)
ggplot(solM %>%
filter(Site == "HJA"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## MEF ----
pdf(file.path(here::here("plots"),
"FWMCPlotMEF_20220324.pdf"), width = 10, height = 10)
ggplot(solM %>%
filter(Site == "MEF"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## SLP ----
pdf(file.path(here::here("plots"),
"FWMCPlotSLP_20220324.pdf"), width = 5, height = 10)
ggplot(solM %>%
filter(Site == "SLP"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
## TLW ----
pdf(file.path(here::here("plots"),
"FWMCPlotTLW_20220324.pdf"), width = 15, height = 10)
ggplot(solM %>%
filter(Site == "TLW"), aes(y = FWMC, x = Date)) +
geom_point()+
facet_grid(Solute ~ SiteWs, scales = "free_y") +
ylab("Flow-weighted mean conc (mg solute/L)")
dev.off()
# Libraries ----
library(tidyverse)
# data
sol <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"))
head(sol)
# data
sol <- read.csv(file.path(here::here("data/JMHnewMungedDat"),
"01c_ProcessedConcDataAllSites.csv"), row.names =1) %>%
mutate(Date = as.POSIXct(Date, format = "%Y-%m-%d"))
head(sol)
# Conc plots ----
## all sites ----
# NOTE: NOT ALL TDP VALUES ARE TDP SEE WATERSHED DATA NOTES SPREADSHEET
pdf(file.path(here::here("plots"),
"RawConcPlotAllSites20220323.pdf"), width = 25, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
summary(sol)
## TLW ----
pdf(file.path(here::here("plots"),
"RawConcPlotTLW_20220323.pdf"), width = 15, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "TLW"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## MEF ----
pdf(file.path(here::here("plots"),
"RawConcPlotMEF_20220323.pdf"), width = 10, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "MEF"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## HJA ----
pdf(file.path(here::here("plots"),
"RawConcPlotHJA_20220323.pdf"), width = 10, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "HJA"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## HBEF ----
pdf(file.path(here::here("plots"),
"RawConcPlotHBEF_20220323.pdf"), width = 20, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "HBEF"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## ELA ----
pdf(file.path(here::here("plots"),
"RawConcPlotELA_20220323.pdf"), width = 12, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "ELA"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## DOR ----
pdf(file.path(here::here("plots"),
"RawConcPlotDOR_20220323.pdf"), width = 25, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "DOR"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
## BBWM ----
pdf(file.path(here::here("plots"),
"RawConcPlotBBWM_20220323.pdf"), width = 5, height = 10)
ggplot(sol %>%
pivot_longer(col = c(Q_Ls:SO4_mgL), names_to = "solute", values_to = "conc") %>%
mutate(solute = fct_relevel(solute,
c("Q_Ls", "Ca_mgL", "DOC_mgL", "NH4_mgL", "NO3_mgL", "TDP_mgL", "SO4_mgL"))) %>%
filter(Site == "BBWM"), aes(y = conc, x = Date, color = Site)) +
geom_point(size = 0.5) +
facet_grid(solute ~ SiteWs, scales = "free_y")
dev.off()
